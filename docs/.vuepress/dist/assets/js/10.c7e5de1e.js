(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{231:function(a,s,n){"use strict";n.r(s);var e=n(2),t=Object(e.a)({},(function(){var a=this,s=a.$createElement,n=a._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h1",{attrs:{id:"linux下lnmp环境简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#linux下lnmp环境简介","aria-hidden":"true"}},[a._v("#")]),a._v(" Linux下LNMP环境简介")]),a._v(" "),n("h2",{attrs:{id:"lnmpa安装"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lnmpa安装","aria-hidden":"true"}},[a._v("#")]),a._v(" LNMPA安装")]),a._v(" "),n("ul",[n("li",[a._v("网址：http://lnmp.org/install.html")]),a._v(" "),n("li",[a._v("安装步骤：")])]),a._v(" "),n("blockquote",[n("ol",[n("li",[a._v("使用putty、SSH Secure Shell Client或类似的SSH工具登陆VPS或服务器。")]),a._v(" "),n("li",[a._v("安装前运行screen命令，创建screen会话，防止网络突然掉线或者不小心关闭putty等："),n("code",[a._v("screen -S lnmp")]),a._v("\n如果提示screen: command not found 命令不存在可以执行："),n("code",[a._v("yum install screen")]),a._v(" 或 "),n("code",[a._v("apt-get install screen")]),a._v("安装，详细内容参考"),n("a",{attrs:{href:"http://www.vpser.net/manage/run-screen-lnmp.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("screen教程"),n("OutboundLink")],1),a._v("。")]),a._v(" "),n("li",[a._v("下载并安装LNMP一键安装包：可以选择使用下载版（推荐国外或者美国VPS使用）或者完整版（推荐国内VPS使用），两者没什么区别，只是完整版把一些需要的源码文件预先放到安装包里。\n安装LNMP执行："),n("code",[a._v("wget -c http://soft.vpser.net/lnmp/lnmp1.2-full.tar.gz && tar zxf lnmp1.2-full.tar.gz && cd lnmp1.2-full && ./install.sh lnmp")]),a._v("。\n需要安装LNMPA或LAMP，将./install.sh 后面的参数替换为lnmpa或lamp即可。\n备注：安装命令可以分别执行\n"),n("ul",[n("li",[n("code",[a._v("wget -c http://soft.vpser.net/lnmp/lnmp1.2-full.tar.gz")])]),a._v(" "),n("li",[n("code",[a._v("tar zxf lnmp1.2-full.tar.gz")])]),a._v(" "),n("li",[n("code",[a._v("cd lnmp1.2-full")])]),a._v(" "),n("li",[n("code",[a._v("./install.sh lnmpa")]),a._v(" "),n("strong",[a._v("备注：")])]),a._v(" "),n("li",[a._v("lnmpa = lnmp + Apache")]),a._v(" "),n("li",[a._v("MySQL版本：MySQL 5.5.42（default）（安装最新的吧）")]),a._v(" "),n("li",[a._v("PHP版本：PHP 5.4.40（default）（ecshop建议安装5.4）")]),a._v(" "),n("li",[a._v("Apache版本：Apache 2.4.10")]),a._v(" "),n("li",[a._v("Nginx、MySQL、PHP都是running，80和3306端口都存在，并Install lnmp V1.2 completed! enjoy it.的话，说明已经安装成功。")])])])])]),a._v(" "),n("h2",{attrs:{id:"安装-memcached"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装-memcached","aria-hidden":"true"}},[a._v("#")]),a._v(" 安装 Memcached")]),a._v(" "),n("p",[a._v("进入lnmp解压后的目录，执行："),n("code",[a._v("./addons.sh install memcached")]),a._v(" "),n("a",{attrs:{href:"https://www.cmhello.com/lnmp-memcached.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("LNMP 开启 Memcached 内存缓存加速网站"),n("OutboundLink")],1),a._v("\n卸载是："),n("code",[a._v("./addons.sh uninstall memcached")])]),a._v(" "),n("p",[a._v("YII用的是memcache，不是memcached，安装的时候，选择1")]),a._v(" "),n("h2",{attrs:{id:"添加虚拟主机"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#添加虚拟主机","aria-hidden":"true"}},[a._v("#")]),a._v(" 添加虚拟主机")]),a._v(" "),n("p",[n("code",[a._v("lnmp vhost add")])]),a._v(" "),n("blockquote",[n("p",[n("strong",[a._v("备注")])]),a._v(" "),n("ol",[n("li",[a._v("带"),n("code",[a._v("www")]),a._v("和不带"),n("code",[a._v("www")]),a._v("的是不同的域名，若需同时访问，需要同时绑定。")]),a._v(" "),n("li",[a._v("网站目录的路径必须为全路径（即以/开头的完整路径）。")]),a._v(" "),n("li",[a._v("日志"),n("code",[a._v("Y")]),a._v("直接回车默认即可。")]),a._v(" "),n("li",[a._v("MySQL一般使用外部的数据库，此处"),n("code",[a._v("N")]),a._v("。")])])]),a._v(" "),n("p",[a._v("备注：虚拟主机默认是root账号所有，程序等读写文件会有权限问题，需要修改虚拟主机目录的读写权限。\n例如虚拟主机目录："),n("code",[a._v("/data/www/about")]),a._v("，命令如下：")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("chmod -R 777 /data/www/about\nchown -R www:www /data/www/about\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br")])]),n("h2",{attrs:{id:"伪静态管理"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#伪静态管理","aria-hidden":"true"}},[a._v("#")]),a._v(" 伪静态管理")]),a._v(" "),n("blockquote",[n("p",[a._v("虚拟主机配置文件："),n("code",[a._v("/usr/local/nginx/conf/vhost/域名.conf")]),a._v("\n伪静态规则文件需要放在"),n("code",[a._v("/usr/local/nginx/conf/")]),a._v("下面")])]),a._v(" "),n("h2",{attrs:{id:"列出网站（虚拟主机）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#列出网站（虚拟主机）","aria-hidden":"true"}},[a._v("#")]),a._v(" 列出网站（虚拟主机）")]),a._v(" "),n("p",[n("code",[a._v("lnmp vhost list")])]),a._v(" "),n("h2",{attrs:{id:"删除网站（虚拟主机）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#删除网站（虚拟主机）","aria-hidden":"true"}},[a._v("#")]),a._v(" 删除网站（虚拟主机）")]),a._v(" "),n("p",[n("code",[a._v("lnmp vhost del")])]),a._v(" "),n("blockquote",[n("p",[a._v("以上命令只是删除虚拟主机配置文件，网站文件并不会删除，需要自己删除。\nchattr -i /网站目录/.user.ini后才能删除网站目录")])]),a._v(" "),n("h2",{attrs:{id:"默认网站（虚拟主机）"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#默认网站（虚拟主机）","aria-hidden":"true"}},[a._v("#")]),a._v(" 默认网站（虚拟主机）")]),a._v(" "),n("blockquote",[n("p",[a._v("LNMP默认网站配置文件："),n("code",[a._v("/usr/local/nginx/conf/nginx.conf")]),a._v("\nLNMPA默认网站配置文件："),n("code",[a._v("/usr/local/nginx/conf/nginx.conf")]),a._v("和"),n("code",[a._v("/usr/local/apache/conf/extra/httpd-vhosts.conf")]),a._v("\nLAMP默认网站配置文件："),n("code",[a._v("/usr/local/apache/conf/extra/httpd-vhosts.conf")])])]),a._v(" "),n("h2",{attrs:{id:"修改虚拟主机配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#修改虚拟主机配置","aria-hidden":"true"}},[a._v("#")]),a._v(" 修改虚拟主机配置")]),a._v(" "),n("blockquote",[n("p",[a._v("Nginx配置文件："),n("code",[a._v("/usr/local/nginx/conf/vhost/")]),a._v("目录下的相关文件。\nApache配置文件："),n("code",[a._v("/usr/local/apache/conf/vhost/")]),a._v("目录下的相关文件。\n修改完成后，需重启Nginx或者Apache后才生效。")])]),a._v(" "),n("h2",{attrs:{id:"反向代理设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#反向代理设置","aria-hidden":"true"}},[a._v("#")]),a._v(" 反向代理设置")]),a._v(" "),n("ol",[n("li",[a._v("修改nginx的虚拟主机配置。eg："),n("code",[a._v("www.abc.com.conf")]),a._v("。原文件内容如下：")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("server\n    {\n        listen 80;\n        #listen [::]:80;\n        server_name www.abc.com abc.com;\n        index index.html index.htm index.php default.html default.htm default.php;\n        root  /data/www/test;\n\n        location /\n        {\n            try_files $uri @apache;\n        }\n\n        location @apache\n        {\n            internal;\n            proxy_pass http://127.0.0.1:88;\n            include proxy.conf;\n        }\n\n        location ~ [^/]\\.php(/|$)\n        {\n            proxy_pass http://127.0.0.1:88;\n            include proxy.conf;\n        }\n\n        location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n        {\n            expires      30d;\n        }\n\n        location ~ .*\\.(js|css)?$\n        {\n            expires      12h;\n        }\n\n        access_log off;\n    }\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br"),n("span",{staticClass:"line-number"},[a._v("24")]),n("br"),n("span",{staticClass:"line-number"},[a._v("25")]),n("br"),n("span",{staticClass:"line-number"},[a._v("26")]),n("br"),n("span",{staticClass:"line-number"},[a._v("27")]),n("br"),n("span",{staticClass:"line-number"},[a._v("28")]),n("br"),n("span",{staticClass:"line-number"},[a._v("29")]),n("br"),n("span",{staticClass:"line-number"},[a._v("30")]),n("br"),n("span",{staticClass:"line-number"},[a._v("31")]),n("br"),n("span",{staticClass:"line-number"},[a._v("32")]),n("br"),n("span",{staticClass:"line-number"},[a._v("33")]),n("br"),n("span",{staticClass:"line-number"},[a._v("34")]),n("br"),n("span",{staticClass:"line-number"},[a._v("35")]),n("br"),n("span",{staticClass:"line-number"},[a._v("36")]),n("br"),n("span",{staticClass:"line-number"},[a._v("37")]),n("br"),n("span",{staticClass:"line-number"},[a._v("38")]),n("br")])]),n("p",[a._v("修改为")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("server\n    {\n        listen 80;\n        server_name www.abc.com abc.com;\n\n        location /\n        {\n            proxy_pass              http://xxx.xxx.xxx.xxx:xx;\n            proxy_redirect          off;\n            proxy_set_header        X-Real-IP       $remote_addr;\n            proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for; \n        }\n\n        access_log off;\n    }\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br")])]),n("p",[a._v("其中"),n("code",[a._v("http://xxx.xxx.xxx.xxx:xx")]),a._v("为代理的服务器。")]),a._v(" "),n("ol",{attrs:{start:"2"}},[n("li",[a._v("检查nginx的配置是否正常："),n("code",[a._v("/usr/local/nginx/sbin/nginx -t")]),a._v("。正常时，提示代码如下")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("the configuration file /usr/local/nginx/conf/nginx.conf syntax is ok\nconfiguration file /usr/local/nginx/conf/nginx.conf test is successful\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[n("p",[a._v("使配置生效（可以直接lnmp restart 重启lnmpa环境）：kill -HUP "),n("code",[a._v("cat /usr/local/nginx/logs/nginx.pid")]),a._v(" 。")])]),a._v(" "),n("li",[n("p",[a._v("配置生效后就可以用域名访问代理的网站了。")])])]),a._v(" "),n("h2",{attrs:{id:"mysql"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mysql","aria-hidden":"true"}},[a._v("#")]),a._v(" mySQL")]),a._v(" "),n("h3",{attrs:{id:"重设mysql的root密码"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#重设mysql的root密码","aria-hidden":"true"}},[a._v("#")]),a._v(" 重设mySQL的root密码")]),a._v(" "),n("p",[a._v("执行如下命令：")]),a._v(" "),n("blockquote",[n("p",[n("code",[a._v("wget http://soft.vpser.net/lnmp/ext/reset_mysql_root_password.sh")]),a._v(" "),n("code",[a._v("sh reset_mysql_root_password.sh")])])]),a._v(" "),n("h3",{attrs:{id:"防火墙开放3306端口"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#防火墙开放3306端口","aria-hidden":"true"}},[a._v("#")]),a._v(" 防火墙开放3306端口")]),a._v(" "),n("ul",[n("li",[a._v("执行命令："),n("code",[a._v("vi /etc/sysconfig/iptables")])]),a._v(" "),n("li",[a._v("添加以下记录："),n("code",[a._v("-A INPUT -p tcp -m tcp --dport 3306 -j ACCEPT")])]),a._v(" "),n("li",[a._v("保存退出")])]),a._v(" "),n("h2",{attrs:{id:"nginx与apache禁止目录执行php文件权限"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx与apache禁止目录执行php文件权限","aria-hidden":"true"}},[a._v("#")]),a._v(" Nginx与Apache禁止目录执行php文件权限")]),a._v(" "),n("p",[a._v("服务器配置过程中，经常需要对指定的目录进行权限配置，比如上传目录，是属于不安全目录，我们需要禁止其执行php脚本的权限，nginx与apache禁止目录执行php文件权限方法如下：\n"),n("strong",[a._v("Nginx禁止目录执行php文件权限")]),a._v("\n打开Nginx相应的虚拟主机配置文件，在server处添加如下代码\n（禁止data/csv目录执行php文件权限）")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("location ~ /data/csv/.*.(php|php5)?$\n{\n\tdeny all;\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("（禁止data与upload目录执行php文件权限）")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("location ~ /(data|upload)/.*.(php|php5)?$\n{\n\tdeny all;\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("配置完后，重启Nginx即可。")]),a._v(" "),n("p",[n("strong",[a._v("Apache禁止目录执行php文件权限")]),a._v("\n以Apache 模块方式运行 PHP，打开Apache相应的虚拟主机配置文件，在文件中添加如下代码：\n（禁止data/csv目录执行php文件权限）")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('<Directory /data/www/about/trunk/data/csv>\n\tphp_flag engine off\n\t<Files ~ ".php">\n\t\tOrder allow,deny\n\t\tDeny from all\n\t</Files>\n</Directory>\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])]),n("p",[a._v("配置完成后，重启Apache即可。")]),a._v(" "),n("blockquote",[n("p",[n("strong",[a._v("参考网站")])]),a._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"http://www.php100.com/html/program/nginx/2013/0905/5534.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("nginx与Apache禁止目录执行php文件权限"),n("OutboundLink")],1)])])]),a._v(" "),n("h2",{attrs:{id:"nginx与apache禁止-htaccess文件下载"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx与apache禁止-htaccess文件下载","aria-hidden":"true"}},[a._v("#")]),a._v(" Nginx与Apache禁止.htaccess文件下载")]),a._v(" "),n("p",[n("strong",[a._v("apache配置")]),a._v("\n在虚拟主机的配置文件中的Directory里面，添加如下代码：")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("<Files .htaccess>  \n\tOrder allow,deny  \n\tdeny from all  \n</Files>  \n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[n("strong",[a._v("nginx配置")]),a._v("\n在虚拟主机的配置文件中，添加如下代码：")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("location ~ /.htaccess$\n{\n\tdeny all;\n}\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("配置完成后，重启lnmp环境。")]),a._v(" "),n("h2",{attrs:{id:"lnmpa-设置404等错误页面"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lnmpa-设置404等错误页面","aria-hidden":"true"}},[a._v("#")]),a._v(" LNMPA 设置404等错误页面")]),a._v(" "),n("p",[n("strong",[a._v("方法一")]),a._v("：设置"),n("code",[a._v(".htaccess")]),a._v("文件，添加如下代码：")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("ErrorDocument 400 /errpage/400.html\nErrorDocument 401 /errpage/401.html\nErrorDocument 403 /errpage/403.html\nErrorDocument 404 /errpage/404.html\nErrorDocument 405 /errpage/405.html\nErrorDocument 500 /errpage/500.html\nErrorDocument 503 /errpage/503.html\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])]),n("p",[n("strong",[a._v("方法二")]),a._v("：设置nginx配置\n①：修改"),n("code",[a._v("/usr/local/nginx/conf/nginx.conf")]),a._v("文件\n在fastcgi_temp_file_write_size 128k; 下面添加")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("fastcgi_intercept_errors on;\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br")])]),n("p",[a._v("②：修改虚拟主机的配置文件，eg："),n("code",[a._v("/usr/local/nginx/conf/vhost/www.abc.com.log")]),a._v("\n添加如下代码：")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("error_page 400 = /errpage/400.html;\nerror_page 401 = /errpage/401.html;\nerror_page 403 = /errpage/403.html;\nerror_page 404 = /errpage/404.html;\nerror_page 405 = /errpage/405.html;\nerror_page 500 = /errpage/500.html;\nerror_page 503 = /errpage/503.html;\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br")])]),n("p",[a._v("③：测试配置："),n("code",[a._v("/usr/local/nginx/sbin/nginx -t")]),a._v("\n④：没有错误就重启nginx："),n("code",[a._v("/etc/init.d/nginx restart")])]),a._v(" "),n("h2",{attrs:{id:"lnmpa的ip访问的默认网站设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lnmpa的ip访问的默认网站设置","aria-hidden":"true"}},[a._v("#")]),a._v(" LNMPA的IP访问的默认网站设置")]),a._v(" "),n("ol",[n("li",[a._v("配置nginx：打开文件"),n("code",[a._v("/usr/local/nginx/conf/nginx.conf")]),a._v("文件，在"),n("code",[a._v("server")]),a._v(" 处编辑站点绑定的目录")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("listen 80 default_server;\n#listen [::]:80 default_server ipv6only=on;\nserver_name www.lnmp.org;\nindex index.html index.htm index.php;\nroot  /data/www/about;\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[a._v("配置apache：打开文件："),n("code",[a._v("/usr/local/apache/conf/extra/httpd-vhosts.conf")]),a._v("文件，编辑站点绑定的目录")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('<VirtualHost *:88>\nServerAdmin webmaster@example.com\n#php_admin_value open_basedir "/data/www/about:/tmp/:/var/tmp/:/proc/"\nDocumentRoot "/data/www/about"\nServerName www.lnmp.org\nErrorLog "/data/wwwlogs/IP-error_log"\nCustomLog "/data/wwwlogs/IP-access_log" common\n<Directory "/data/www/about">\n    SetOutputFilter DEFLATE\n    Options FollowSymLinks\n    AllowOverride All\n    Order allow,deny\n    Allow from all\n    DirectoryIndex index.html index.php\n</Directory>\n</VirtualHost>\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[n("p",[a._v("测试 nginx 和 apache 配置是否正确。")])]),a._v(" "),n("li",[n("p",[a._v("重启 lnmp，使其生效即可")])])]),a._v(" "),n("p",[n("strong",[a._v("备注")]),a._v("\n默认站点使用的端口号为80端口，apache使用的端口号为88端口。\n在给该IP设置虚拟主机时，不要占用这两个端口。")]),a._v(" "),n("h2",{attrs:{id:"lnmpa使用ip-端口号的形式访问站点设置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#lnmpa使用ip-端口号的形式访问站点设置","aria-hidden":"true"}},[a._v("#")]),a._v(" LNMPA使用IP + 端口号的形式访问站点设置")]),a._v(" "),n("p",[a._v("此IP为服务器分配的IP，以192.168.0.66:8880为例")]),a._v(" "),n("ol",[n("li",[a._v("配置 nginx：打开文件"),n("code",[a._v("/usr/local/nginx/conf/vhost/192.168.0.66.conf")]),a._v("，为其添加站点配置")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("server\n    {\n        listen 8880;\n        #listen [::]:80;\n        server_name 192.168.0.66;\n        index index.html index.htm index.php default.html default.htm default.php;\n        root  /data/www/guide;\n\n        location /\n        {\n            try_files $uri @apache;\n        }\n\n        location @apache\n        {\n            internal;\n            proxy_pass http://127.0.0.1:880;\n            include proxy.conf;\n        }\n\n        location ~ [^/]\\.php(/|$)\n        {\n            proxy_pass http://127.0.0.1:880;\n            include proxy.conf;\n        }\n\n        location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n        {\n            expires      30d;\n        }\n\n        location ~ .*\\.(js|css)?$\n        {\n            expires      12h;\n        }\n        access_log  /data/wwwlogs/192.168.0.66.log  access;\n    }\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br"),n("span",{staticClass:"line-number"},[a._v("24")]),n("br"),n("span",{staticClass:"line-number"},[a._v("25")]),n("br"),n("span",{staticClass:"line-number"},[a._v("26")]),n("br"),n("span",{staticClass:"line-number"},[a._v("27")]),n("br"),n("span",{staticClass:"line-number"},[a._v("28")]),n("br"),n("span",{staticClass:"line-number"},[a._v("29")]),n("br"),n("span",{staticClass:"line-number"},[a._v("30")]),n("br"),n("span",{staticClass:"line-number"},[a._v("31")]),n("br"),n("span",{staticClass:"line-number"},[a._v("32")]),n("br"),n("span",{staticClass:"line-number"},[a._v("33")]),n("br"),n("span",{staticClass:"line-number"},[a._v("34")]),n("br"),n("span",{staticClass:"line-number"},[a._v("35")]),n("br"),n("span",{staticClass:"line-number"},[a._v("36")]),n("br"),n("span",{staticClass:"line-number"},[a._v("37")]),n("br")])]),n("ol",{attrs:{start:"2"}},[n("li",[a._v("配置 apache ：打开文件"),n("code",[a._v("/usr/local/apache/conf/vhost/192.168.0.66.conf")]),a._v("，为其添加站点配置（nginx里面为apache设置的端口号为880）")])]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v('<VirtualHost *:880>\nServerAdmin webmaster@example.com\nphp_admin_value open_basedir "/data/www/guide:/tmp/:/var/tmp/:/proc/"\nDocumentRoot "/data/www/guide"\nServerName 192.168.0.66\nErrorLog "/data/wwwlogs/192.168.0.66-error_log"\nCustomLog "/data/wwwlogs/192.168.0.66-access_log" common\n<Directory "/data/www/guide">\n    SetOutputFilter DEFLATE\n    Options FollowSymLinks\n    AllowOverride All\n    Order allow,deny\n    Allow from all\n    DirectoryIndex index.html index.php\n</Directory>\n</VirtualHost>\n')])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br")])]),n("ol",{attrs:{start:"3"}},[n("li",[n("p",[a._v("测试 nginx 和 apache 配置是否正确。")])]),a._v(" "),n("li",[n("p",[a._v("重启 lnmp，使其生效即可")])])]),a._v(" "),n("h2",{attrs:{id:"常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#常用命令","aria-hidden":"true"}},[a._v("#")]),a._v(" 常用命令")]),a._v(" "),n("blockquote",[n("ul",[n("li",[a._v("检测nginx配置是否正确："),n("code",[a._v("/usr/local/nginx/sbin/nginx -t")])]),a._v(" "),n("li",[a._v("重启nginx："),n("code",[a._v("/usr/local/nginx/sbin/nginx -s reload")])]),a._v(" "),n("li",[a._v("检测apache配置是否正确：切换到apache目录 "),n("code",[a._v("cd /usr/local/apache/bin/")]),a._v(" 使用test："),n("code",[a._v("./apachectl configtest")])]),a._v(" "),n("li",[a._v("重启apache："),n("code",[a._v("service httpd restart")]),a._v(" 或者 "),n("code",[a._v("/etc/rc.d/init.d/httpd restart")])])])]),a._v(" "),n("p",[a._v("nginx编译")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("./configure --user=www --group=www --prefix=/usr/local/nginx --with-http_stub_status_module --with-http_ssl_module --with-http_spdy_module --with-http_gzip_static_module --with-ipv6 --with-http_sub_module --with-http_mp4_module --with-http_flv_module\nmake\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br")])]),n("h2",{attrs:{id:"相关网站"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#相关网站","aria-hidden":"true"}},[a._v("#")]),a._v(" 相关网站")]),a._v(" "),n("p",[n("a",{attrs:{href:"http://lnmp.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("LNMP一键安装包"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=t.exports}}]);